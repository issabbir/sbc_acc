---PARTY DUPLICATE CHECK FIN_SBCODE----
SELECT A.SB_CODE, COUNT(*) FROM FIN_SBCODE A GROUP BY A.SB_CODE;

SELECT A.DESCRIPTION, COUNT(*) FROM FIN_SBCODE A GROUP BY  A.DESCRIPTION;  --find duplicate

SELECT * FROM FIN_SBCODE a WHERE (a.DESCRIPTION) IN
    (SELECT b.DESCRIPTION FROM FIN_SBCODE b GROUP BY b.DESCRIPTION
        HAVING COUNT(*) > 1
    )
ORDER BY a.DESCRIPTION;

---PARTY DUPLICATE CHECK FIN_CUSTOMERS----
SELECT A.SB_CODE, COUNT(*) FROM FIN_CUSTOMERS A GROUP BY A.SB_CODE;

SELECT A.PARTY_NAME, COUNT(*) FROM FIN_CUSTOMERS A GROUP BY A.PARTY_NAME;   --find duplicate

SELECT * FROM FIN_CUSTOMERS a WHERE (a.PARTY_NAME) IN
    (SELECT b.PARTY_NAME FROM FIN_CUSTOMERS b GROUP BY b.PARTY_NAME
        HAVING COUNT(*) > 1
    )
ORDER BY a.PARTY_NAME;


---MERGE FIN_CUSTOMERS & FIN_SBCODE----
SELECT A.SB_CODE, A.PARTY_NAME, B.SB_CODE, B.DESCRIPTION, B.ADD1, B.ADD2, B.HEAD_OP_DATE, B.ENLISTED, B.EMAIL, B.MOBILE_NO, B.INSERT_DATE
FROM FIN_CUSTOMERS A, FIN_SBCODE B WHERE A.SB_CODE = B.SB_CODE
ORDER BY A.PARTY_NAME;


SELECT * 
FROM FIN_CUSTOMERS A, L_AGENCY	B WHERE LOWER(A.PARTY_NAME) = LOWER(B.AGENCY_NAME);

SELECT A.SB_CODE,A.DESCRIPTION,A.HEAD_OP_DATE,A.MOBILE_NO,B.AGENCY_TYPE_ID,B.AGENCY_NAME,B.MOBILE_NO, B.CP_MOBILE_NO
FROM FIN_SBCODE A, L_AGENCY B 
WHERE (LOWER(A.DESCRIPTION) = LOWER(B.AGENCY_NAME) OR  A.MOBILE_NO = B.MOBILE_NO )
ORDER BY A.DESCRIPTION;